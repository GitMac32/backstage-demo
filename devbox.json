{
  "$schema": "https://raw.githubusercontent.com/jetify-com/devbox/0.12.0/.schema/devbox.schema.json",
  "packages": [
    "nodejs@22.5.1",
    "yarn@1.22.22",
    "zellij@0.40.1",
    "yq-go@4.44.3",
    "teller@2.0.7",
    "kind@0.24.0",
    "kubernetes-helm@3.15.4"
  ],
  "shell": {
    "init_hook": [],
    "scripts":   {
      "plugins": [
        "yarn --cwd src/packages/backend add @backstage/plugin-scaffolder-backend-module-github",
        "yarn --cwd src/packages/backend add @backstage/plugin-catalog-backend-module-github",
        "cp packages/backend/src/index.ts src/packages/backend/src/index.ts"
      ],
      "package": [
        "docker image build --build-arg SRC=src --tag $IMAGE:$TAG .",
        "docker image push $IMAGE:$TAG",
        "yq --inplace \".version = \\\"$TAG\\\"\" chart/Chart.yaml",
        "yq --inplace \".appVersion = \\\"$TAG\\\"\" chart/Chart.yaml",
        "helm package chart",
        "helm push backstage-demo-$TAG.tgz $HELM_REGISTRY"
      ]
    }
  }
}
